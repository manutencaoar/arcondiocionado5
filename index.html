<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SGM - Sistema de Gest√£o de Manuten√ß√£o</title>
    <style>
        :root {
            --primary: #0284c7;
            --secondary: #64748b;
            --success: #22c55e;
            --danger: #ef4444;
            --bg: #f1f5f9;
            --card: #ffffff;
            --text: #1e293b;
        }

        body { font-family: 'Segoe UI', system-ui, sans-serif; background: var(--bg); color: var(--text); margin: 0; padding: 20px; }
        .container { max-width: 900px; margin: 0 auto; }
        
        /* Navega√ß√£o */
        nav { display: flex; gap: 10px; margin-bottom: 20px; justify-content: center; }
        nav button { padding: 10px 20px; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; transition: 0.3s; }
        .btn-nav { background: var(--secondary); color: white; }
        .btn-nav.active { background: var(--primary); }

        /* Pain√©is */
        .panel { background: var(--card); padding: 25px; border-radius: 12px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); display: none; }
        .panel.active { display: block; }

        /* Formul√°rios */
        .grid-form { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px; }
        input, select, textarea { width: 100%; padding: 12px; border: 1px solid #cbd5e1; border-radius: 6px; box-sizing: border-box; }
        .full-width { grid-column: span 2; }
        button.main { background: var(--primary); color: white; border: none; padding: 12px; border-radius: 6px; width: 100%; cursor: pointer; font-weight: bold; }

        /* Lista de Equipamentos */
        .card-equip { border: 1px solid #e2e8f0; padding: 15px; border-radius: 8px; margin-bottom: 15px; position: relative; }
        .card-equip h4 { margin: 0 0 10px 0; color: var(--primary); }
        .badge { display: inline-block; padding: 4px 8px; border-radius: 4px; font-size: 12px; font-weight: bold; background: #e0f2fe; color: var(--primary); }
        
        .history-item { font-size: 14px; border-left: 3px solid var(--primary); padding-left: 10px; margin-top: 10px; }
        
        .search-box { margin-bottom: 20px; padding: 10px; font-size: 16px; border: 2px solid var(--primary); }

        @media (max-width: 600px) { .grid-form { grid-template-columns: 1fr; } .full-width { grid-column: span 1; } }
    </style>
</head>
<body>

<div class="container">
    <nav>
        <button class="btn-nav active" onclick="switchPanel('tecnico')">√Årea do T√©cnico</button>
        <button class="btn-nav" onclick="switchPanel('cliente')">√Årea do Cliente</button>
    </nav>

    <div id="tecnico" class="panel active">
        <h2>Painel Administrativo</h2>
        
        <div class="grid-form">
            <input type="text" id="nomeCliente" placeholder="Nome do Cliente">
            <input type="text" id="modelo" placeholder="Modelo do Aparelho (Ex: LG Dual Inverter)">
            <input type="text" id="btus" placeholder="Capacidade (BTUs)">
            <input type="date" id="dataInstalacao">
            <button class="main full-width" onclick="cadastrarEquipamento()">Cadastrar Equipamento</button>
        </div>

        <hr>
        <h3>Equipamentos Cadastrados</h3>
        <div id="listaTecnico"></div>
    </div>

    <div id="cliente" class="panel">
        <h2>Consulta de Manuten√ß√µes</h2>
        <input type="text" id="buscaCliente" class="search-box" placeholder="Digite seu nome para buscar..." onkeyup="buscarCliente()">
        
        <div id="resultadoBusca">
            <p style="text-align: center; color: #64748b;">Digite seu nome acima para ver seus aparelhos.</p>
        </div>
    </div>
</div>

<script>
    // Inicializa√ß√£o de dados
    let db = JSON.parse(localStorage.getItem('sgm_dados')) || [];

    function switchPanel(panelId) {
        document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
        document.querySelectorAll('.btn-nav').forEach(b => b.classList.remove('active'));
        
        document.getElementById(panelId).classList.add('active');
        event.currentTarget.classList.add('active');
        
        if(panelId === 'tecnico') listarTecnico();
    }

    function cadastrarEquipamento() {
        const cliente = document.getElementById('nomeCliente').value;
        const modelo = document.getElementById('modelo').value;
        const btus = document.getElementById('btus').value;
        const data = document.getElementById('dataInstalacao').value;

        if(!cliente || !modelo) return alert("Preencha ao menos Nome e Modelo!");

        const novo = {
            id: Date.now(),
            cliente: cliente,
            modelo: modelo,
            btus: btus,
            data: data,
            historico: []
        };

        db.push(novo);
        salvar();
        listarTecnico();
        
        // Limpar campos
        document.querySelectorAll('#tecnico input').forEach(i => i.value = '');
    }

    function adicionarManutencao(id) {
        const desc = prompt("Descri√ß√£o da manuten√ß√£o realizada:");
        if(!desc) return;

        const index = db.findIndex(item => item.id === id);
        const registro = {
            data: new Date().toLocaleDateString('pt-BR'),
            servico: desc
        };

        db[index].historico.unshift(registro); // Adiciona no topo
        salvar();
        listarTecnico();
    }

    function excluirEquipamento(id) {
        if(confirm("Deseja remover este equipamento?")) {
            db = db.filter(item => item.id !== id);
            salvar();
            listarTecnico();
        }
    }

    function salvar() {
        localStorage.setItem('sgm_dados', JSON.stringify(db));
    }

    function listarTecnico() {
        const lista = document.getElementById('listaTecnico');
        lista.innerHTML = '';

        db.forEach(item => {
            lista.innerHTML += `
                <div class="card-equip">
                    <h4>${item.cliente}</h4>
                    <span class="badge">${item.modelo} - ${item.btus} BTUs</span>
                    <p><small>Instalado em: ${item.data || 'N√£o informada'}</small></p>
                    <button onclick="adicionarManutencao(${item.id})">+ Adicionar Manuten√ß√£o</button>
                    <button onclick="excluirEquipamento(${item.id})" style="color:var(--danger); background:none; border:none; cursor:pointer">Excluir</button>
                    <div id="hist-${item.id}">
                        ${item.historico.map(h => `<div class="history-item"><strong>${h.data}</strong>: ${h.servico}</div>`).join('')}
                    </div>
                </div>
            `;
        });
    }

    function buscarCliente() {
        const termo = document.getElementById('buscaCliente').value.toLowerCase();
        const resultado = document.getElementById('resultadoBusca');
        
        if(termo.length < 2) {
            resultado.innerHTML = '<p style="text-align: center; color: #64748b;">Digite ao menos 2 letras.</p>';
            return;
        }

        const filtrados = db.filter(item => item.cliente.toLowerCase().includes(termo));
        
        if(filtrados.length === 0) {
            resultado.innerHTML = '<p>Nenhum aparelho encontrado para este nome.</p>';
            return;
        }

        resultado.innerHTML = filtrados.map(item => `
            <div class="card-equip">
                <h4>${item.modelo}</h4>
                <p><strong>Capacidade:</strong> ${item.btus} BTUs</p>
                <div class="history">
                    <strong>Hist√≥rico de Manuten√ß√µes:</strong>
                    ${item.historico.length ? 
                        item.historico.map(h => `<div class="history-item">üìÖ ${h.data} - ${h.servico}</div>`).join('') 
                        : '<p>Nenhuma manuten√ß√£o registrada ainda.</p>'}
                </div>
            </div>
        `).join('');
    }

    // Carregar lista ao abrir
    listarTecnico();
</script>

</body>
</html>
